import Mathlib.V2.Certify

-- basic certificates
example : Nat.Prime 19 := by pratt {19, 2, {2, {3, 2, {2}}}}
example : Nat.Prime 19 := by pratt [2, (3, 2, [2]), (19, 2, [2, 3])]
example : Nat.Prime 37 := by pratt {37, 2, {2, {3, 2, {2}}}}
example : Nat.Prime 37 := by pratt [2, (3, 2, [2]), (37, 2, [2, 3])]
example : Nat.Prime 53 := by pratt {53, 2, {2, {13, 2, {2, {3, 2, {2}}}}}}
example : Nat.Prime 53 := by pratt [2, (3, 2, [2]), (13, 2, [2, 3]), (53, 2, [2, 13])]
example : Nat.Prime 97 := by pratt {97, 5, {2, {3, 2, {2}}}}
example : Nat.Prime 97 := by pratt [2, (3, 2, [2]), (97, 5, [2, 3])]

-- hide the really small primes
example : Nat.Prime 101 := by pratt {101, 2, {2, {5, 2, {2}}}}
example : Nat.Prime 101 := by pratt {101, 2, {2, 5}}
example : Nat.Prime 101 := by pratt [2, (5, 2, [2]), (101, 2, [2, 5])]
example : Nat.Prime 101 := by pratt [2, 5, (101, 2, [2, 5])]

example : Nat.Prime 103 := by pratt {103, 5, {2, 3, {17, 3, {2}}}}
example : Nat.Prime 103 := by pratt {103, 5, {2, 3, 17}}

example : Nat.Prime 107 := by pratt
  {107, 2, {2, {53, 2, {2, {13, 2, {2, {3, 2, {2}}}}}}}}
example : Nat.Prime 107 := by pratt {107, 2, {2, 53}}

-- the tactic helps you find the certificate (a bit)
example : Nat.Prime 109 := by pratt {109, 6, {2, 3}}
example : Nat.Prime 113 := by pratt {113, 3, {2, 7}}
example : Nat.Prime 127 := by pratt {127, 3, {2, 3, 7}}
example : Nat.Prime 1270249 := by pratt
  {1270249, 11, {2, 3, 7, {7561, 13, {2, 3, 5, 7}}}}

example : Nat.Prime 1270249 := by pratt
  [2, 3, 5, 7, (7561, 13, [2, 3, 5, 7]), (1270249, 11, [2, 3, 7, 7561])]

example : Nat.Prime 101 := by pratt
  [2, 5, (101, 2, [2, 5])]

example : Nat.Prime 101 := by pratt [2, 5, (101, 2, [2, 5])]

-- or you can ask mathematica!
example : Nat.Prime 1873 := by pratt {1873, 10, {2, 3, 13}}
example : Nat.Prime 1873 := by pratt [2, 3, 13, (1873, 10, [2, 3, 13])]
example : Nat.Prime 1873 := by pratt [2, 3, 13, (1873, 10, [2, 3, 13])]

example : Nat.Prime 47867742232066880047611079 := by
  pratt
      {47867742232066880047611079, 3, {2, 3, 7, 29, {62311, 6, {2, 3, 5, 31, 67}},
        {90101681149415123, 2, {2, 11, 17, {214499, 2, {2, 23, {4663, 3, {2, 3, 7, 37}}}},
          {1123145497, 7, {2, 3, 11, {283, 3, {2, 3, 47}},
            {5011, 2, {2, 3, 5, {167, 5, {2, 83}}}}}}}}}}

example : Nat.Prime 47867742232066880047611079 := by
  pratt
      [2, 3, 5, 7, 11, 17, 23, 29, 31, 37, 47, 67, 83, (167, 5, [2, 83]), (283, 3, [2, 3, 47]),
        (4663, 3, [2, 3, 7, 37]), (5011, 2, [2, 3, 5, 167]), (62311, 6, [2, 3, 5, 31, 67]),
        (214499, 2, [2, 23, 4663]), (1123145497, 7, [2, 3, 11, 283, 5011]),
        (90101681149415123, 2, [2, 11, 17, 214499, 1123145497]),
        (47867742232066880047611079, 3, [2, 3, 7, 29, 62311, 90101681149415123])]

example : Nat.Prime 47867742232066880047611079 := by
  pratt
      [2, 3, 5, 7, 11, 17, 23, 29, 31, 37, 47, 67, 83, (167, 5, [2, 83]), (283, 3, [2, 3, 47]),
        (4663, 3, [2, 3, 7, 37]), (5011, 2, [2, 3, 5, 167]), (62311, 6, [2, 3, 5, 31, 67]),
        (214499, 2, [2, 23, 4663]), (1123145497, 7, [2, 3, 11, 283, 5011]),
        (90101681149415123, 2, [2, 11, 17, 214499, 1123145497]),
        (47867742232066880047611079, 3, [2, 3, 7, 29, 62311, 90101681149415123])]

-- example : Nat.Prime 373 := by prime (generator := .mathematica)

-- -- 605185576317848261+155368778*23#*n for n=0..26 found by MooMoo2 (Michael Kwok) on 2023-12-10 09:53:34 UTC and verified by Davina
-- -- 277699295941594831+170826477*23#*n for n=0..26 found by tng on 2023-05-26 01:04:36 UTC and verified by zvasi_000 (Official Announcement)
-- -- 224584605939537911+81292139*23#*n for n=0..26 found by robish on 2019-09-23 06:25:41 UTC and verified by [DPC] hansR (Official Announcement)

lemma green_tao_27 : ∀ i < 27, Nat.Prime (224584605939537911 + 18135696597948930 * i) := by
  simp only [Nat.lt_succ_iff_lt_or_eq, not_lt_zero', false_or, or_assoc, Nat.reduceMul,
    forall_eq_or_imp, mul_zero, add_zero, mul_one, Nat.reduceAdd, forall_eq]
  repeat' apply And.intro
  · pratt
      [2, 3, 5, 11, 23, 29, 37, 79, (2371, 2, [2, 3, 5, 79]), (5107, 2, [2, 3, 23, 37]),
        (5569, 13, [2, 3, 29]), (30643, 2, [2, 3, 5107]), (29693250859, 2, [2, 3, 29, 5569, 30643]),
        (224584605939537911, 7, [2, 5, 11, 29, 2371, 29693250859])]
  · pratt
      [2, 3, 5, 7, 11, 59, 73, 89, (439, 15, [2, 3, 73]), (463, 3, [2, 3, 7, 11]),
        (51803, 2, [2, 59, 439]), (310819, 2, [2, 3, 51803]),
        (105053713811, 2, [2, 5, 73, 463, 310819]),
        (242720302537486841, 3, [2, 5, 11, 59, 89, 105053713811])]
  · pratt
      [2, 5, 11, 13, 19, 23, 29, 67, (599, 7, [2, 13, 23]), (4793, 3, [2, 599]),
        (6701, 2, [2, 5, 67]), (97151, 13, [2, 5, 29, 67]), (1943021, 2, [2, 5, 97151]),
        (73834799, 11, [2, 19, 1943021]), (260855999135435771, 2, [2, 5, 11, 4793, 6701, 73834799])]
  · pratt
      [2, 3, 5, 7, 11, 73, 89, (127, 3, [2, 3, 7]), (439, 15, [2, 3, 73]),
        (19559, 13, [2, 7, 11, 127]), (39119, 11, [2, 19559]), (6483519883, 2, [2, 3, 7, 89, 439]),
        (278991695733384701, 2, [2, 5, 11, 39119, 6483519883])]
  · pratt
      [2, 3, 5, 11, 17, 19, 59, 97, (389, 2, [2, 97]), (2243, 2, [2, 19, 59]),
        (7481, 6, [2, 5, 11, 17]), (1492021171, 11, [2, 3, 5, 19, 389, 2243]),
        (32824465763, 2, [2, 11, 1492021171]),
        (297127392331333631, 7, [2, 5, 11, 7481, 32824465763])]
  · pratt
      [2, 3, 5, 11, 13, 17, 19, (109, 6, [2, 3]), (191, 19, [2, 5, 19]), (383, 5, [2, 191]),
        (4597, 5, [2, 3, 383]), (9127, 3, [2, 3, 13]), (51109447, 5, [2, 3, 17, 109, 4597]),
        (306656683, 5, [2, 3, 51109447]), (1226626733, 2, [2, 306656683]),
        (315263088929282561, 6, [2, 5, 11, 9127, 1226626733])]
  · pratt
      [2, 3, 5, 7, 11, 13, 29, 47, (251, 6, [2, 5]), (337, 10, [2, 3, 7]), (2069, 2, [2, 11, 47]),
        (37243, 2, [2, 3, 2069]), (422183, 5, [2, 29, 251]),
        (81381683813, 3, [2, 11, 13, 337, 422183]),
        (333398785527231491, 2, [2, 5, 11, 37243, 81381683813])]
  · pratt
      [2, 3, 5, 7, 11, 37, (223, 3, [2, 3, 37]), (433, 5, [2, 3]), (449, 3, [2, 7]),
        (1999, 3, [2, 3, 37]), (3593, 3, [2, 449]), (83094433, 5, [2, 3, 433, 1999]),
        (7165399146457, 7, [2, 3, 3593, 83094433]),
        (351534482125180421, 3, [2, 5, 11, 223, 7165399146457])]
  · pratt
      [2, 3, 5, 7, 11, 13, 19, 37, 41, (547, 2, [2, 3, 7, 13]), (601, 7, [2, 3, 5]),
        (1559, 19, [2, 19, 41]), (1777, 5, [2, 3, 37]), (17496343, 5, [2, 3, 547, 1777]),
        (369670178723129351, 7, [2, 5, 11, 41, 601, 1559, 17496343])]
  · pratt
      [2, 3, 5, 7, 11, 13, 17, 89, (101, 2, [2, 5]), (131, 2, [2, 5, 13]), (179, 2, [2, 89]),
        (271, 6, [2, 3, 5]), (607, 3, [2, 3, 101]), (14321, 3, [2, 5, 179]),
        (1113239, 7, [2, 7, 131, 607]), (1460743, 3, [2, 3, 17, 14321]),
        (2226479, 13, [2, 1113239]), (387805875321078281, 3, [2, 5, 11, 271, 1460743, 2226479])]
  · pratt
      [2, 3, 5, 7, 11, 13, 17, 47, (101, 2, [2, 5]), (151, 6, [2, 3, 5]), (607, 3, [2, 3, 101]),
        (1093, 5, [2, 3, 7, 13]), (3643, 2, [2, 3, 607]), (4373, 2, [2, 1093]),
        (104953, 5, [2, 3, 4373]), (145721, 3, [2, 5, 3643]), (3568403, 2, [2, 17, 104953]),
        (405941571919027211, 2, [2, 5, 11, 47, 151, 145721, 3568403])]
  · pratt
      [2, 3, 5, 7, 11, 31, 53, (107, 2, [2, 53]), (337, 10, [2, 3, 7]), (59707, 3, [2, 3, 31, 107]),
        (2149453, 5, [2, 3, 59707]), (478081336261, 2, [2, 3, 5, 11, 337, 2149453]),
        (22947904140529, 41, [2, 3, 478081336261]),
        (1927623947804437, 14, [2, 3, 7, 22947904140529]),
        (424077268516976141, 10, [2, 5, 11, 1927623947804437])]
  · pratt
      [2, 3, 5, 7, 11, 31, 37, 89, (179, 2, [2, 89]), (433, 5, [2, 3]), (1433, 3, [2, 179]),
        (1733, 2, [2, 433]), (10399, 6, [2, 3, 1733]), (1539053, 2, [2, 37, 10399]),
        (3232011301, 2, [2, 3, 5, 7, 1539053]), (64840610720663, 5, [2, 7, 1433, 3232011301]),
        (129681221441327, 5, [2, 64840610720663]),
        (442212965114925071, 7, [2, 5, 11, 31, 129681221441327])]
  · pratt
      [2, 3, 5, 7, 11, 13, 17, 73, (409, 21, [2, 3, 17]), (3067, 2, [2, 3, 7, 73]),
        (12269, 2, [2, 3067]), (53171, 2, [2, 5, 13, 409]), (94750723, 3, [2, 3, 11, 53171]),
        (20924939168767, 3, [2, 3, 12269, 94750723]),
        (460348661712874001, 12, [2, 5, 11, 20924939168767])]
  · pratt
      [2, 3, 5, 11, 37, 41, (149, 2, [2, 37]), (181, 2, [2, 3, 5]), (2953, 13, [2, 3, 41]),
        (7451, 2, [2, 5, 149]), (1092241, 11, [2, 3, 5, 37, 41]),
        (478484358310822931, 6, [2, 5, 11, 181, 2953, 7451, 1092241])]
  · pratt
      [2, 3, 5, 11, 23, 37, (139, 2, [2, 3, 23]), (223, 3, [2, 3, 37]), (251, 6, [2, 5]),
        (277, 5, [2, 3, 23]), (57731, 2, [2, 5, 23, 251]), (12832759, 3, [2, 3, 23, 139, 223]),
        (496620054908771861, 2, [2, 5, 11, 277, 57731, 12832759])]
  · pratt
      [2, 3, 5, 7, 11, 43, 53, 73, 83, (107, 2, [2, 53]), (193, 5, [2, 3]), (499, 7, [2, 3, 83]),
        (773, 2, [2, 193]), (77659, 2, [2, 3, 7, 43]), (7795379, 2, [2, 73, 107, 499]),
        (60258279671, 13, [2, 5, 773, 7795379]),
        (514755751506720791, 7, [2, 5, 11, 77659, 60258279671])]
  · pratt
      [2, 3, 5, 7, 11, 13, 17, 23, 53, (107, 2, [2, 53]), (131, 2, [2, 5, 13]),
        (157, 5, [2, 3, 13]), (263, 5, [2, 131]), (443, 2, [2, 13, 17]), (1289, 6, [2, 7, 23]),
        (8861, 2, [2, 5, 443]), (136679486233, 5, [2, 3, 107, 157, 263, 1289]),
        (532891448104669721, 3, [2, 5, 11, 8861, 136679486233])]
  · pratt
      [2, 3, 5, 11, 13, 59, (157, 5, [2, 3, 13]), (401, 3, [2, 5]), (433, 5, [2, 3]),
        (1181, 7, [2, 5, 59]), (3209, 3, [2, 401]), (5653, 5, [2, 3, 157]),
        (8336983, 3, [2, 3, 433, 3209]), (1001867535822943, 3, [2, 3, 1181, 5653, 8336983]),
        (551027144702618651, 2, [2, 5, 11, 1001867535822943])]
  · pratt
      [2, 3, 5, 7, 11, 17, (241, 7, [2, 3, 5]), (409, 21, [2, 3, 17]), (1409, 3, [2, 11]),
        (28523797, 2, [2, 3, 7, 241, 1409]), (2566571254061, 2, [2, 5, 11, 409, 28523797]),
        (2587103824093489, 11, [2, 3, 7, 2566571254061]),
        (569162841300567581, 3, [2, 5, 11, 2587103824093489])]
  · pratt
      [2, 3, 5, 11, 13, 19, 43, (191, 19, [2, 5, 19]), (257, 3, [2]), (487, 3, [2, 3]),
        (2237, 2, [2, 13, 43]), (2299637, 2, [2, 257, 2237]), (14510653, 2, [2, 3, 13, 191, 487]),
        (58042613, 2, [2, 14510653]), (5339077617259241, 3, [2, 5, 2299637, 58042613]),
        (587298537898516511, 11, [2, 5, 11, 5339077617259241])]
  · pratt
      [2, 3, 5, 7, 11, 17, 83, (337, 10, [2, 3, 7]), (919, 7, [2, 3, 17]), (20219, 2, [2, 11, 919]),
        (2685217, 5, [2, 3, 83, 337]), (5823073, 5, [2, 3, 20219]),
        (128107607, 10, [2, 11, 5823073]), (605434234496465441, 3, [2, 5, 11, 2685217, 128107607])]
  · pratt
      [2, 3, 5, 11, 17, 31, 97, (103, 5, [2, 3, 17]), (163, 2, [2, 3]), (619, 2, [2, 3, 103]),
        (1553, 3, [2, 97]), (1861, 2, [2, 3, 5, 31]), (3168721, 7, [2, 3, 5, 163]),
        (623569931094414371, 6, [2, 5, 11, 619, 1553, 1861, 3168721])]
  · pratt
      [2, 3, 5, 11, 17, 19, 29, 37, 53, (109, 6, [2, 3]), (149, 2, [2, 37]), (229, 6, [2, 3, 19]),
        (3271, 3, [2, 3, 5, 109]), (4931, 6, [2, 5, 17, 29]),
        (2232195821, 2, [2, 5, 149, 229, 3271]),
        (641705627692363301, 2, [2, 5, 11, 53, 4931, 2232195821])]
  · pratt
      [2, 3, 5, 7, 11, 41, 67, 71, (401, 3, [2, 5]), (1723, 3, [2, 3, 7, 41]),
        (7237, 2, [2, 3, 67]), (28949, 2, [2, 7237]), (455537, 3, [2, 71, 401]),
        (1273757, 2, [2, 11, 28949]), (7642543, 3, [2, 3, 1273757]),
        (659841324290312231, 7, [2, 5, 11, 1723, 455537, 7642543])]
  · pratt
      [2, 3, 5, 11, 17, 37, 53, 97, (107, 2, [2, 53]), (307, 5, [2, 3, 17]),
        (7919, 7, [2, 37, 107]), (168851, 6, [2, 5, 11, 307]), (3039319, 15, [2, 3, 168851]),
        (194577202381, 2, [2, 3, 5, 11, 97, 3039319]),
        (677977020888261161, 6, [2, 5, 11, 7919, 194577202381])]
  · pratt
      [2, 3, 5, 7, 11, 13, 17, 83, (101, 2, [2, 5]), (103, 5, [2, 3, 17]), (211, 2, [2, 3, 5, 7]),
        (421, 2, [2, 3, 5, 7]), (607, 3, [2, 3, 101]), (43889, 3, [2, 13, 211]),
        (375127, 6, [2, 3, 103, 607]), (696112717486210091, 2, [2, 5, 11, 83, 421, 43889, 375127])]

example : ∃ n k, 0 < n ∧ ∀ i < 27, Nat.Prime (k + n * i) := by
  use 18135696597948930, 224584605939537911, by simp
  exact green_tao_27

example : Nat.Prime 1871326486211461011031931945323874719289347729538762174157135451276879 := by
  pratt
      [2, 3, 5, 7, 11, 13, 17, 19, 29, 41, 43, 47, 83, 89, (113, 3, [2, 7]), (137, 3, [2, 17]),
        (173, 2, [2, 43]), (179, 2, [2, 89]), (193, 5, [2, 3]), (359, 7, [2, 179]),
        (443, 2, [2, 13, 17]), (463, 3, [2, 3, 7, 11]), (613, 2, [2, 3, 17]), (701, 2, [2, 5, 7]),
        (719, 11, [2, 359]), (761, 6, [2, 5, 19]), (773, 2, [2, 193]), (1439, 7, [2, 719]),
        (1523, 2, [2, 761]), (2879, 7, [2, 1439]), (5557, 2, [2, 3, 463]), (11519, 7, [2, 13, 443]),
        (22433, 3, [2, 701]), (27799, 7, [2, 3, 41, 113]), (212099, 2, [2, 173, 613]),
        (977359, 3, [2, 3, 29, 41, 137]), (3255877, 2, [2, 3, 13, 773]),
        (4447841, 3, [2, 5, 27799]), (15573689, 3, [2, 13, 11519]),
        (93323561, 3, [2, 5, 11, 212099]), (311473781, 2, [2, 5, 15573689]),
        (433314067369, 11, [2, 3, 7, 13, 29, 977359]),
        (53539802496967, 5, [2, 3, 47, 1523, 5557, 22433]),
        (336828023987944771, 2, [2, 3, 5, 2879, 433314067369]),
        (2414990925857902095950321353657774391, 43, [2, 5, 3255877, 4447841, 311473781,
          53539802496967]),
        (308651819811240699707531581076318075717983737694501, 2, [2, 3, 5, 11, 83, 93323561,
          2414990925857902095950321353657774391]),
        (1871326486211461011031931945323874719289347729538762174157135451276879, 3, [2, 3,
          336828023987944771, 308651819811240699707531581076318075717983737694501])]

example : Nat.Prime 47867742232066880047611079 := by pratt
    [2, 3, 5, 7, 11, 17, 23, 29, 31, 37, 47, 67, 83, (167, 5, [2, 83]), (283, 3, [2, 3, 47]),
      (4663, 3, [2, 3, 7, 37]), (5011, 2, [2, 3, 5, 167]), (62311, 6, [2, 3, 5, 31, 67]),
      (214499, 2, [2, 23, 4663]), (1123145497, 7, [2, 3, 11, 283, 5011]),
      (90101681149415123, 2, [2, 11, 17, 214499, 1123145497]),
      (47867742232066880047611079, 3, [2, 3, 7, 29, 62311, 90101681149415123])]

-- set_option exponentiation.threshold 3913 in
-- example : Nat.Prime (3 * 2 ^ 3912 + 1) := by
--   simp only [Nat.reducePow, Nat.reduceMul, Nat.reduceAdd]
--   pratt [2, 3, (127780414391497973212171930170926986757577048484820926201064729783485263494817422495127775983679039078116803697168137524940219819335799478153348592755198599590903607242050230924443865709697486743641039970666450337071378658828331722728467720393963808366917988956767802913905167890490075236068196363700359481304279948916896583006686025357237170212018946813663108217900835975808683160984117514866915965161953626338070145596982334808959718966160701183250747572515090867613655044807172211728519357721287835503689517292364425608325467094686443862517374850243698013720305871319056887431952190952721719757200172695537054790570648290887720009455171821568413052107356003828041937567129362866696549587422369864562815134637684140271767482353107080370450890024342225936273158281477009232714640818424893445193089479459814572594522258577931514012256573162006292678354475638319009668319255772179069845291474717503333030909793536116894869761453687330048252587304656806182949368202671739705463406846852567720022377005763291104588535681445561286808586673846016527511475331939430139687698419185010117348285933672139833826832898565919546377321517928825162277951756632134321102813522053716838646284289, 11, [2, 3])]

-- set_option diagnostics true
example : Nat.Prime 6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151 := by
  pratt [
    2,
    3,
    5,
    7,
    11,
    13,
    17,
    19,
    23,
    29,
    31,
    37,
    41,
    43,
    47,
    53,
    59,
    61,
    67,
    71,
    73,
    79,
    89,
    97,
    (101, 2, [2, 5]),
    (103, 5, [2, 3, 17]),
    (107, 2, [2, 53]),
    (109, 6, [2, 3]),
    (113, 3, [2, 7]),
    (127, 3, [2, 3, 7]),
    (131, 2, [2, 5, 13]),
    (139, 2, [2, 3, 23]),
    (149, 2, [2, 37]),
    (151, 6, [2, 3, 5]),
    (157, 5, [2, 3, 13]),
    (163, 2, [2, 3]),
    (173, 2, [2, 43]),
    (179, 2, [2, 89]),
    (181, 2, [2, 3, 5]),
    (191, 19, [2, 5, 19]),
    (193, 5, [2, 3]),
    (197, 2, [2, 7]),
    (199, 3, [2, 3, 11]),
    (211, 2, [2, 3, 5, 7]),
    (223, 3, [2, 3, 37]),
    (227, 2, [2, 113]),
    (229, 6, [2, 3, 19]),
    (233, 3, [2, 29]),
    (239, 7, [2, 7, 17]),
    (241, 7, [2, 3, 5]),
    (251, 6, [2, 5]),
    (257, 3, [2]),
    (263, 5, [2, 131]),
    (269, 2, [2, 67]),
    (271, 6, [2, 3, 5]),
    (277, 5, [2, 3, 23]),
    (281, 3, [2, 5, 7]),
    (283, 3, [2, 3, 47]),
    (293, 2, [2, 73]),
    (311, 17, [2, 5, 31]),
    (313, 10, [2, 3, 13]),
    (317, 2, [2, 79]),
    (331, 3, [2, 3, 5, 11]),
    (337, 10, [2, 3, 7]),
    (347, 2, [2, 173]),
    (349, 2, [2, 3, 29]),
    (373, 2, [2, 3, 31]),
    (397, 5, [2, 3, 11]),
    (421, 2, [2, 3, 5, 7]),
    (439, 15, [2, 3, 73]),
    (491, 2, [2, 5, 7]),
    (509, 2, [2, 127]),
    (521, 3, [2, 5, 13]),
    (547, 2, [2, 3, 7, 13]),
    (569, 3, [2, 71]),
    (593, 3, [2, 37]),
    (599, 7, [2, 13, 23]),
    (607, 3, [2, 3, 101]),
    (619, 2, [2, 3, 103]),
    (631, 3, [2, 3, 5, 7]),
    (641, 3, [2, 5]),
    (653, 2, [2, 163]),
    (659, 2, [2, 7, 47]),
    (661, 2, [2, 3, 5, 11]),
    (683, 5, [2, 11, 31]),
    (727, 5, [2, 3, 11]),
    (757, 2, [2, 3, 7]),
    (811, 3, [2, 3, 5]),
    (877, 2, [2, 3, 73]),
    (881, 3, [2, 5, 11]),
    (907, 2, [2, 3, 151]),
    (919, 7, [2, 3, 17]),
    (937, 5, [2, 3, 13]),
    (1031, 14, [2, 5, 103]),
    (1033, 5, [2, 3, 43]),
    (1051, 7, [2, 3, 5, 7]),
    (1087, 3, [2, 3, 181]),
    (1117, 2, [2, 3, 31]),
    (1187, 2, [2, 593]),
    (1201, 11, [2, 3, 5]),
    (1237, 2, [2, 3, 103]),
    (1283, 2, [2, 641]),
    (1297, 10, [2, 3]),
    (1303, 6, [2, 3, 7, 31]),
    (1319, 13, [2, 659]),
    (1373, 2, [2, 7]),
    (1381, 2, [2, 3, 5, 23]),
    (1433, 3, [2, 179]),
    (1511, 11, [2, 5, 151]),
    (1531, 2, [2, 3, 5, 17]),
    (1543, 5, [2, 3, 257]),
    (1553, 3, [2, 97]),
    (1579, 3, [2, 3, 263]),
    (1613, 3, [2, 13, 31]),
    (1663, 3, [2, 3, 277]),
    (1693, 2, [2, 3, 47]),
    (1889, 3, [2, 59]),
    (2063, 5, [2, 1031]),
    (2089, 7, [2, 3, 29]),
    (2153, 3, [2, 269]),
    (2213, 2, [2, 7, 79]),
    (2389, 2, [2, 3, 199]),
    (2411, 6, [2, 5, 241]),
    (2437, 2, [2, 3, 7, 29]),
    (2477, 2, [2, 619]),
    (2707, 2, [2, 3, 11, 41]),
    (2731, 3, [2, 3, 5, 7, 13]),
    (3023, 5, [2, 1511]),
    (3191, 11, [2, 5, 11, 29]),
    (3253, 2, [2, 3, 271]),
    (3407, 5, [2, 13, 131]),
    (3433, 5, [2, 3, 11, 13]),
    (3517, 2, [2, 3, 293]),
    (3677, 2, [2, 919]),
    (3739, 7, [2, 3, 7, 89]),
    (3769, 7, [2, 3, 157]),
    (4127, 5, [2, 2063]),
    (4349, 2, [2, 1087]),
    (5449, 7, [2, 3, 227]),
    (6043, 5, [2, 3, 19, 53]),
    (6317, 2, [2, 1579]),
    (6829, 2, [2, 3, 569]),
    (8191, 17, [2, 3, 5, 7, 13]),
    (8389, 6, [2, 3, 233]),
    (8699, 2, [2, 4349]),
    (9227, 2, [2, 7, 659]),
    (9547, 2, [2, 3, 37, 43]),
    (10861, 2, [2, 3, 5, 181]),
    (10909, 2, [2, 3, 101]),
    (14461, 2, [2, 3, 5, 241]),
    (15601, 23, [2, 3, 5, 13]),
    (16657, 5, [2, 3, 347]),
    (16879, 3, [2, 3, 29, 97]),
    (16979, 2, [2, 13, 653]),
    (17293, 7, [2, 3, 11, 131]),
    (17449, 14, [2, 3, 727]),
    (17467, 3, [2, 3, 41, 71]),
    (18169, 11, [2, 3, 757]),
    (20341, 2, [2, 3, 5, 113]),
    (20599, 3, [2, 3, 3433]),
    (21407, 5, [2, 7, 11, 139]),
    (23609, 6, [2, 13, 227]),
    (28793, 3, [2, 59, 61]),
    (30859, 2, [2, 3, 37, 139]),
    (34429, 2, [2, 3, 19, 151]),
    (37447, 3, [2, 3, 79]),
    (38189, 2, [2, 9547]),
    (38557, 2, [2, 3, 7, 17]),
    (42641, 3, [2, 5, 13, 41]),
    (49481, 3, [2, 5, 1237]),
    (51419, 2, [2, 47, 547]),
    (51481, 17, [2, 3, 5, 11, 13]),
    (53197, 2, [2, 3, 11, 13, 31]),
    (54251, 2, [2, 5, 7, 31]),
    (54623, 5, [2, 31, 881]),
    (60449, 3, [2, 1889]),
    (61681, 29, [2, 3, 5, 257]),
    (64901, 2, [2, 5, 11, 59]),
    (65537, 3, [2]),
    (65677, 2, [2, 3, 13, 421]),
    (78283, 3, [2, 3, 4349]),
    (85999, 3, [2, 3, 11, 1303]),
    (87739, 7, [2, 3, 7, 2089]),
    (92581, 6, [2, 3, 5, 1543]),
    (104471, 11, [2, 5, 31, 337]),
    (126241, 7, [2, 3, 5, 263]),
    (133279, 3, [2, 3, 97, 229]),
    (145091, 2, [2, 5, 11, 1319]),
    (149309, 2, [2, 163, 229]),
    (155317, 5, [2, 3, 7, 43]),
    (161969, 3, [2, 53, 191]),
    (166571, 2, [2, 5, 16657]),
    (166823, 5, [2, 239, 349]),
    (248431, 3, [2, 3, 5, 7, 13]),
    (274177, 5, [2, 3, 7, 17]),
    (275729, 3, [2, 19, 907]),
    (312289, 14, [2, 3, 3253]),
    (330563, 2, [2, 19, 8699]),
    (336757, 2, [2, 3, 7, 19, 211]),
    (363557, 2, [2, 97, 937]),
    (370471, 3, [2, 3, 5, 53, 233]),
    (379787, 2, [2, 11, 61, 283]),
    (409891, 14, [2, 3, 5, 13, 1051]),
    (455737, 11, [2, 3, 17, 1117]),
    (490463, 14, [2, 7, 53, 661]),
    (495527, 5, [2, 41, 6043]),
    (568151, 17, [2, 5, 11, 1033]),
    (704251, 2, [2, 3, 5, 313]),
    (723127, 3, [2, 3, 191, 631]),
    (777241, 7, [2, 3, 5, 17, 127]),
    (858001, 17, [2, 3, 5, 11, 13]),
    (1276987, 2, [2, 3, 29, 41, 179]),
    (2995763, 2, [2, 7, 11, 397]),
    (2998279, 3, [2, 3, 166571]),
    (3969899, 2, [2, 19, 104471]),
    (5746001, 15, [2, 5, 13, 17]),
    (6051631, 6, [2, 3, 5, 13, 59, 263]),
    (6700417, 5, [2, 3, 17449]),
    (6937379, 2, [2, 7, 495527]),
    (7623851, 6, [2, 5, 13, 37, 317]),
    (8196883, 2, [2, 3, 79, 17293]),
    (8413201, 29, [2, 3, 5, 19, 41]),
    (8463023, 5, [2, 113, 37447]),
    (8620289, 3, [2, 151, 223]),
    (9211861, 2, [2, 3, 5, 7, 2437]),
    (9350987, 2, [2, 17, 229, 1201]),
    (9863677, 5, [2, 3, 311, 881]),
    (10577321, 17, [2, 5, 13, 20341]),
    (10924559, 7, [2, 59, 92581]),
    (11105363, 2, [2, 509, 10909]),
    (11393611, 10, [2, 3, 5, 379787]),
    (13928737, 15, [2, 3, 145091]),
    (15716741, 2, [2, 5, 13, 60449]),
    (19353437, 2, [2, 277, 17467]),
    (34110701, 15, [2, 5, 13, 19, 1381]),
    (46245989, 2, [2, 1693, 6829]),
    (51920273, 3, [2, 61, 53197]),
    (103840547, 2, [2, 51920273]),
    (105957871, 3, [2, 3, 5, 19, 211, 881]),
    (154950581, 2, [2, 5, 17, 455737]),
    (186406729, 7, [2, 3, 61, 157, 811]),
    (187019741, 2, [2, 5, 9350987]),
    (191039911, 3, [2, 3, 5, 41, 155317]),
    (204061199, 11, [2, 11, 23, 107, 3769]),
    (246608641, 19, [2, 3, 5, 21407]),
    (252396031, 3, [2, 3, 5, 8413201]),
    (272109983, 5, [2, 19, 73, 233, 421]),
    (290064143, 5, [2, 79, 491, 3739]),
    (308761441, 17, [2, 3, 5, 13, 49481]),
    (311245691, 2, [2, 5, 7, 17, 29, 311]),
    (513928823, 5, [2, 11, 59, 599, 661]),
    (532247449, 7, [2, 3, 61, 363557]),
    (622491383, 5, [2, 311245691]),
    (821796863, 5, [2, 37, 11105363]),
    (1458105463, 3, [2, 3, 11, 311, 877]),
    (2400573761, 3, [2, 5, 13, 347, 1663]),
    (2534364967, 3, [2, 3, 7, 8620289]),
    (2862218959, 3, [2, 3, 157, 1373, 2213]),
    (24098228377, 7, [2, 3, 109, 9211861]),
    (34282281433, 17, [2, 3, 7, 204061199]),
    (53448597593, 3, [2, 13, 513928823]),
    (65427463921, 17, [2, 3, 5, 7, 13, 2995763]),
    (66417393611, 6, [2, 5, 53, 173, 197, 3677]),
    (101785224689, 3, [2, 7, 131, 6937379]),
    (228572385721, 23, [2, 3, 5, 7, 272109983]),
    (455827231987, 2, [2, 3, 7, 43, 252396031]),
    (674750394557, 2, [2, 7, 24098228377]),
    (807145746439, 3, [2, 3, 47, 2862218959]),
    (1002328039319, 19, [2, 126241, 3969899]),
    (1436833069313, 3, [2, 16979, 330563]),
    (11290956913871, 13, [2, 5, 17, 66417393611]),
    (23314383343543, 3, [2, 3, 17, 228572385721]),
    (37344768852931, 3, [2, 3, 5, 7, 11, 149, 9863677]),
    (43800962361397, 6, [2, 3, 41, 10861, 8196883]),
    (44925942675193, 5, [2, 3, 3517, 532247449]),
    (67280421310721, 3, [2, 5, 47, 373, 2998279]),
    (108140989558681, 17, [2, 3, 5, 13, 683, 1433, 23609]),
    (145295143558111, 7, [2, 3, 5, 7, 13, 2534364967]),
    (432621809776543, 3, [2, 3, 87739, 821796863]),
    (7244839476697597, 2, [2, 3, 239, 54623, 46245989]),
    (7532705587894727, 5, [2, 29, 43, 331, 4127, 51419]),
    (46076956964474543, 5, [2, 23, 18169, 704251, 78283]),
    (55942463741690639, 7, [2, 7, 107, 37344768852931]),
    (60018716061994831, 7, [2, 3, 5, 7, 19, 777241, 19353437]),
    (108341181769254293, 2, [2, 17, 43, 2477, 54251, 275729]),
    (208150935158385979, 2, [2, 3, 11, 43, 127, 3023, 191039911]),
    (361725589517273017, 17, [2, 3, 7, 3191, 674750394557]),
    (1357291859799823621, 2, [2, 3, 5, 67, 6317, 53448597593]),
    (5933177618131140283, 2, [2, 3, 723127, 455827231987]),
    (88599952463812275001, 11, [2, 3, 5, 19, 281, 1187, 186406729]),
    (426632512014427833817, 11, [2, 3, 13, 89, 659, 23314383343543]),
    (529709925838459440593, 3, [2, 7, 181, 105957871, 246608641]),
    (3473195323567808068309, 2, [2, 3, 13, 19, 59, 9227, 65677, 10924559]),
    (4239602065187190872179, 2, [2, 3, 61, 193, 60018716061994831]),
    (35581458644053887931343, 5, [2, 17, 41, 568151, 44925942675193]),
    (120699720968197491947347, 3, [2, 3, 13, 34429, 290064143, 154950581]),
    (1647781915921980690468599, 13, [2, 17, 547, 88599952463812275001]),
    (9564682313913860059195669, 2, [2, 3, 7, 15716741, 7244839476697597]),
    (136401162692544977256234449, 3, [2, 31, 30859, 20599, 432621809776543]),
    (173308343918874810521923841, 3, [2, 5, 13, 28793, 361725589517273017]),
    (288626509448065367648032903, 6, [2, 3, 19, 37, 607, 5933177618131140283]),
    (1124679999981664229965379347, 2, [2, 3, 1553, 120699720968197491947347]),
    (1495199339761412565498084319, 6, [2, 3, 64901, 426632512014427833817]),
    (2624747550333869278416773953, 7, [2, 3, 1297, 16879, 208150935158385979]),
    (3433859179316188682119986911, 13, [2, 5, 439, 103840547, 7532705587894727]),
    (17942392077136950785977011829, 6, [2, 3, 1495199339761412565498084319]),
    (23964610537191310276190549303, 5, [2, 336757, 35581458644053887931343]),
    (862725979338887169942859774909, 2, [2, 3, 23964610537191310276190549303]),
    (20705423504133292078628634597817, 5, [2, 3, 862725979338887169942859774909]),
    (34646440928557194402992574983797, 2, [2, 3, 61, 347, 136401162692544977256234449]),
    (144471089338257942164514676806340723, 11,
      [2, 3, 11, 109, 14461, 133279, 3473195323567808068309]),
    (7427946019382605513260578233234962521, 3,
      [2, 5, 43800962361397, 4239602065187190872179]),
    (375503554633724504423937478103159147573209, 19,
      [2, 3, 2707, 166823, 34646440928557194402992574983797]),
    (413244619895455989650825325680172591660047, 5,
      [2, 17, 97, 6051631, 20705423504133292078628634597817]),
    (12397338596863679689524759770405177749801411, 2,
      [2, 3, 5, 413244619895455989650825325680172591660047]),
    (774023187263532362759620327192479577272145303, 3,
      [2, 3, 2411, 11290956913871, 34282281433, 46076956964474543]),
    (835945042244614951780389953367877943453916927241, 11,
      [2, 3, 5, 774023187263532362759620327192479577272145303]),
    (15994076126984618329123851002118749004583184815459808099, 2,
      [2, 10577321, 101785224689, 7427946019382605513260578233234962521]),
    (6277101735386680763835789423176059013767194773182842284081, 3,
      [2, 5, 2389, 9564682313913860059195669, 3433859179316188682119986911]),
    (6277101735386680763835789423207666416083908700390324961279, 11,
      [2, 59, 149309, 11393611, 108341181769254293, 288626509448065367648032903]),
    (50520606258875818707470860153287666700917696099933389351507, 2,
      [2, 89, 631, 85999, 13928737, 375503554633724504423937478103159147573209]),
    (1059392654943455286185473617842338478315215895509773412096307, 2,
      [2, 251, 248431, 8463023, 55942463741690639, 17942392077136950785977011829]),
    (26959946667150639794667015087019625940457807714424391721682722368061, 2,
      [2, 3, 5, 17, 2153, 50520606258875818707470860153287666700917696099933389351507]),
    (26959946667150639794667015087019630673557916260026308143510066298881, 22,
      [2, 3, 5, 17, 257, 641, 65537, 274177, 6700417, 67280421310721]),
    (115792089210356248762697446949407573529996955224135760342422259061068512044369, 7,
      [2, 3, 71, 131, 373, 3407, 17449, 38189, 1002328039319, 187019741, 622491383,
        2624747550333869278416773953]),
    (115792089210356248762697446949407573530086143415290314195533631308867097853951, 6,
      [2, 3, 5, 17, 257, 641, 1531, 65537, 490463, 6700417,
        835945042244614951780389953367877943453916927241]),
    (3055465788140352002733946906144561090641249606160407884365391979704929268480326390471,
      12,
      [2, 3, 5, 151, 347, 1276987, 1436833069313,
        1059392654943455286185473617842338478315215895509773412096307]),
    (19173790298027098165721053155794528970226934547887232785722672956982046098136719667167519737147526097,
      3, [2, 11, 8389, 38557, 312289, 1357291859799823621, 529709925838459440593,
      12397338596863679689524759770405177749801411]),
    (3636410625392624440351547907325502812950802686368714273274221490761556277859337865760708490235892541081304511,
      19,
      [2, 5, 19, 263, 5449, 15601, 370471, 144471089338257942164514676806340723,
        15994076126984618329123851002118749004583184815459808099]),
    (39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643,
      2, [2, 3, 7, 13, 1124679999981664229965379347,
           3055465788140352002733946906144561090641249606160407884365391979704929268480326390471]),
    (39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319,
      19,
      [2, 19, 67, 807145746439,
        19173790298027098165721053155794528970226934547887232785722672956982046098136719667167519737147526097]),
    (3615194794881930010216942559103847593050265703173292383701371712350878926821661243755933835426896058418509759880171943,
      3, [2, 3, 11, 31, 161969,
           3636410625392624440351547907325502812950802686368714273274221490761556277859337865760708490235892541081304511]),
    (6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449,
      3, [2, 7, 11, 1283, 1458105463, 1647781915921980690468599,
           3615194794881930010216942559103847593050265703173292383701371712350878926821661243755933835426896058418509759880171943]),
    (6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151,
      3, [2, 3, 5, 11, 17, 31, 41, 53, 131, 157, 521, 1613, 2731, 8191, 61681, 51481, 42641,
           409891, 858001, 7623851, 5746001, 34110701, 308761441, 2400573761, 65427463921,
           108140989558681, 145295143558111, 173308343918874810521923841])
  ]

example : Nat.Prime (2 ^ 255 - 19) := by
  have : 2 ^ 255 - 19 =
    57896044618658097711785492504343953926634992332820282019728792003956564819949 := rfl
  rw [this]
  pratt
    [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 83, 97, (103, 5, [2, 3, 17]),
        (107, 2, [2, 53]), (127, 3, [2, 3, 7]), (131, 2, [2, 5, 13]), (173, 2, [2, 43]),
        (223, 3, [2, 3, 37]), (239, 7, [2, 7, 17]), (353, 3, [2, 11]), (419, 2, [2, 11, 19]),
        (479, 13, [2, 239]), (487, 3, [2, 3]), (991, 6, [2, 3, 5, 11]), (1723, 3, [2, 3, 7, 41]),
        (2437, 2, [2, 3, 7, 29]), (3727, 3, [2, 3, 23]), (4153, 5, [2, 3, 173]),
        (9463, 3, [2, 3, 19, 83]), (32573, 2, [2, 17, 479]), (37853, 2, [2, 9463]),
        (57467, 2, [2, 59, 487]), (65147, 2, [2, 32573]), (75707, 2, [2, 37853]),
        (132049, 26, [2, 3, 7, 131]), (430751, 17, [2, 5, 1723]), (569003, 2, [2, 7, 97, 419]),
        (1923133, 2, [2, 3, 43, 3727]), (8574133, 2, [2, 3, 7, 103, 991]),
        (2773320623, 5, [2, 2437, 569003]), (72106336199, 7, [2, 13, 2773320623]),
        (1919519569386763, 2, [2, 3, 7, 19, 47, 127, 8574133]),
        (31757755568855353, 10, [2, 3, 31, 107, 223, 4153, 430751]),
        (75445702479781427272750846543864801, 7, [2, 3, 5, 75707, 72106336199, 1919519569386763]),
        (74058212732561358302231226437062788676166966415465897661863160754340907, 2, [2, 3, 353,
          57467, 132049, 1923133, 31757755568855353, 75445702479781427272750846543864801]),
        (57896044618658097711785492504343953926634992332820282019728792003956564819949, 2, [2, 3,
          65147, 74058212732561358302231226437062788676166966415465897661863160754340907])]
